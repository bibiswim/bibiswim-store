{% comment %}
  Renders breadcrumb navigation
  
  Usage:
  {% render 'breadcrumbs' %}
{% endcomment %}

<nav class="breadcrumbs" role="navigation" aria-label="Breadcrumb" id="breadcrumbs-nav" {% if template.name == 'product' %}style="display: none;"{% endif %}>
  <ol class="breadcrumbs__list" id="breadcrumbs-list">
    <li class="breadcrumbs__item">
      <a href="{{ routes.root_url }}" class="breadcrumbs__link">
        Home
      </a>
      <span class="breadcrumbs__separator" aria-hidden="true">›</span>
    </li>

    {% if template.name == 'product' %}
      {%- comment -%}
        Show breadcrumb only if user came from a collection page (stored in sessionStorage).
        If no sessionStorage data, hide the entire breadcrumb.
      {%- endcomment -%}
      
      {%- comment -%} Placeholder for collection breadcrumb - will be populated by JS {%- endcomment -%}
      <li class="breadcrumbs__item breadcrumbs__item--collection" id="breadcrumb-collection">
        <a href="" class="breadcrumbs__link" id="breadcrumb-collection-link"></a>
        <span class="breadcrumbs__separator" aria-hidden="true">›</span>
      </li>
      
      <li class="breadcrumbs__item breadcrumbs__item--current">
        <span class="breadcrumbs__text" aria-current="page">
          {{ product.title }}
        </span>
      </li>
      
      <script>
        (function() {
          try {
            const stored = sessionStorage.getItem('breadcrumb_collection');
            if (stored) {
              const collectionData = JSON.parse(stored);
              const breadcrumbNav = document.getElementById('breadcrumbs-nav');
              const collectionLink = document.getElementById('breadcrumb-collection-link');
              
              if (breadcrumbNav && collectionLink && collectionData.title && collectionData.url) {
                // Populate and show the breadcrumb
                collectionLink.href = collectionData.url;
                collectionLink.textContent = collectionData.title;
                breadcrumbNav.style.display = '';
              }
            }
            // If no stored data, breadcrumb stays hidden
          } catch (err) {
            // sessionStorage unavailable or parse error - breadcrumb stays hidden
          }
        })();
      </script>

    {% elsif template.name == 'collection' %}
      <li class="breadcrumbs__item breadcrumbs__item--current">
        <span class="breadcrumbs__text" aria-current="page">
          {{ collection.title }}
        </span>
      </li>

    {% elsif template.name == 'page' %}
      <li class="breadcrumbs__item breadcrumbs__item--current">
        <span class="breadcrumbs__text" aria-current="page">
          {{ page.title }}
        </span>
      </li>

    {% elsif template.name == 'blog' %}
      <li class="breadcrumbs__item breadcrumbs__item--current">
        <span class="breadcrumbs__text" aria-current="page">
          {{ blog.title }}
        </span>
      </li>

    {% elsif template.name == 'article' %}
      <li class="breadcrumbs__item">
        <a href="{{ blog.url }}" class="breadcrumbs__link">
          {{ blog.title }}
        </a>
        <span class="breadcrumbs__separator" aria-hidden="true">›</span>
      </li>
      
      <li class="breadcrumbs__item breadcrumbs__item--current">
        <span class="breadcrumbs__text" aria-current="page">
          {{ article.title }}
        </span>
      </li>
    {% endif %}
  </ol>
</nav>
